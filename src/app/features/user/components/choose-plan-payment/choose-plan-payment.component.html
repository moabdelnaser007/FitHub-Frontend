<div class="payment-page">
  <app-header></app-header>

  <main class="payment-container">
    <section class="payment-content">
      <!-- Page Header -->
      <div class="page-header">
        <h1 class="page-title">Choose Your Plan & Payment</h1>
        <p class="page-subtitle">Select a credit plan and your preferred payment method.</p>
      </div>

      <div class="payment-grid">
        <!-- Left Column: Plans -->
        <div class="plans-section">
          <div class="plans-header">
            <h2 class="section-title">Select Credit Plan</h2>
          </div>

          <div class="plans-list">
            <!-- Basic Plan -->
            <div
              class="plan-card"
              [class.selected]="selectedPlan?.id === 'basic'"
              (click)="selectPlan(plans[0])"
            >
              <div class="plan-badge"></div>
              <div class="plan-content">
                <h3 class="plan-name">{{ plans[0].name }}</h3>
                <div class="plan-price">
                  <span class="amount">{{ plans[0].price }}</span>
                  <span class="currency">/ month</span>
                </div>
                <div class="plan-credits">
                  <span class="checkmark">✓</span>
                  <span>{{ plans[0].credits }} credits</span>
                </div>
              </div>
              <button class="plan-button" [class.selected]="selectedPlan?.id === 'basic'">
                {{ selectedPlan?.id === 'basic' ? 'Selected' : 'Select Plan' }}
              </button>
            </div>

            <!-- Premium Plan -->
            <div
              class="plan-card premium-highlighted"
              [class.selected]="selectedPlan?.id === 'premium'"
              (click)="selectPlan(plans[1])"
            >
              <div class="plan-badge popular-badge">Most Popular</div>
              <div class="plan-content">
                <h3 class="plan-name">{{ plans[1].name }}</h3>
                <div class="plan-price">
                  <span class="amount">{{ plans[1].price }}</span>
                  <span class="currency">/ month</span>
                </div>
                <div class="plan-credits">
                  <span class="checkmark">✓</span>
                  <span>{{ plans[1].credits }} credits</span>
                </div>
              </div>
              <button class="plan-button selected">
                {{ selectedPlan?.id === 'premium' ? 'Plan Selected' : 'Select Plan' }}
              </button>
            </div>

            <!-- Gold Plan -->
            <div
              class="plan-card"
              [class.selected]="selectedPlan?.id === 'gold'"
              (click)="selectPlan(plans[2])"
            >
              <div class="plan-badge"></div>
              <div class="plan-content">
                <h3 class="plan-name">{{ plans[2].name }}</h3>
                <div class="plan-price">
                  <span class="amount">{{ plans[2].price }}</span>
                  <span class="currency">/ month</span>
                </div>
                <div class="plan-credits">
                  <span class="checkmark">✓</span>
                  <span>{{ plans[2].credits }} credits</span>
                </div>
              </div>
              <button class="plan-button" [class.selected]="selectedPlan?.id === 'gold'">
                {{ selectedPlan?.id === 'gold' ? 'Selected' : 'Select Plan' }}
              </button>
            </div>
          </div>
        </div>

        <!-- Right Column: Payment -->
        <div class="payment-section">
          <div class="payment-card">
            <h2 class="section-title">Payment Method</h2>

            <!-- Payment Method Options -->
            <div class="payment-methods">
              <div
                *ngFor="let method of paymentMethods"
                class="payment-option"
                [class.selected]="selectedPaymentMethod?.id === method.id"
                (click)="selectPaymentMethod(method)"
              >
                <input
                  type="radio"
                  [checked]="selectedPaymentMethod?.id === method.id"
                  [value]="method.id"
                  name="paymentMethod"
                  class="radio-input"
                />
                <span class="radio-custom"></span>
                <span class="method-icon">{{ method.icon }}</span>
                <span class="method-name">{{ method.name }}</span>
              </div>
            </div>

            <!-- Card Payment Form -->
            <div
              *ngIf="selectedPaymentMethod?.id === 'card'"
              class="card-form"
              [formGroup]="paymentForm"
            >
              <div class="form-group">
                <label for="cardholderName" class="form-label">Cardholder Name</label>
                <input
                  id="cardholderName"
                  type="text"
                  class="form-input"
                  placeholder="Enter name on card"
                  formControlName="cardholderName"
                />
              </div>

              <div class="form-group">
                <label for="cardNumber" class="form-label">Card Number</label>
                <input
                  id="cardNumber"
                  type="text"
                  class="form-input"
                  placeholder="0000 0000 0000 0000"
                  maxlength="19"
                  (input)="onCardNumberChange($event)"
                  formControlName="cardNumber"
                />
              </div>

              <div class="form-row">
                <div class="form-group">
                  <label for="expiryDate" class="form-label">Expiry Date</label>
                  <input
                    id="expiryDate"
                    type="text"
                    class="form-input"
                    placeholder="MM/YY"
                    maxlength="5"
                    (input)="onExpiryChange($event)"
                    formControlName="expiryDate"
                  />
                </div>
                <div class="form-group">
                  <label for="cvv" class="form-label">CVV</label>
                  <input
                    id="cvv"
                    type="text"
                    class="form-input"
                    placeholder="123"
                    maxlength="3"
                    formControlName="cvv"
                  />
                </div>
              </div>

              <div class="checkbox-group">
                <input
                  id="saveCard"
                  type="checkbox"
                  class="checkbox-input"
                  [(ngModel)]="saveCardForFuture"
                />
                <label for="saveCard" class="checkbox-label">Save card for future payments</label>
              </div>
            </div>

            <!-- E-Wallet Payment Info -->
            <div *ngIf="selectedPaymentMethod?.id === 'ewallet'" class="payment-info">
              <p class="info-text">
                You will be redirected to the E-Wallet payment gateway to complete your transaction
                securely.
              </p>
            </div>

            <!-- InstaPay Payment Info -->
            <div *ngIf="selectedPaymentMethod?.id === 'instapay'" class="payment-info">
              <p class="info-text">
                You will be redirected to InstaPay to complete your payment securely.
              </p>
            </div>

            <!-- Total & Action -->
            <div class="payment-summary">
              <div class="total-row">
                <span class="total-label">Total Due Today:</span>
                <span class="total-amount">{{ totalDue }} EGP</span>
              </div>
              <button class="btn-proceed" (click)="proceedToPayment()">Proceed to Payment</button>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>
</div>
