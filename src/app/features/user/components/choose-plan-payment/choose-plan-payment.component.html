<div class="payment-page">
  <!-- Header -->
  <header class="top-nav">
    <a class="brand" routerLink="/"> FitHub </a>
    <nav class="nav-links">
      <a *ngFor="let link of navLinks" [routerLink]="link.isRoute ? link.href : null"
        [href]="link.isRoute ? null : link.href" (click)="handleNav(link, $event)">{{ link.label }}</a>
    </nav>
    <div class="auth-actions">
      <ng-container *ngIf="!isLoggedIn">
        <button class="ghost" routerLink="/login">Log in</button>
        <button class="primary" routerLink="/register">Sign Up</button>
      </ng-container>
      <ng-container *ngIf="isLoggedIn">
        <button class="profile-btn" (click)="navigateToProfile()" title="Go to Profile">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path
              d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"
              fill="currentColor" />
          </svg>
        </button>
        <button class="logout-btn" (click)="logout()" title="Logout">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path
              d="M17 7l-1.41 1.41L18.17 11H8v2h10.17l-2.58 2.58L17 17l5-5zM4 5h8V3H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h8v-2H4V5z"
              fill="currentColor" />
          </svg>
        </button>
      </ng-container>
    </div>
  </header>

  <main class="payment-container">
    <section class="payment-content">
      <!-- Page Header -->
      <div class="page-header">
        <h1 class="page-title">Choose Your Plan & Payment</h1>
        <p class="page-subtitle">Select a credit plan and your preferred payment method.</p>
      </div>

      <div class="payment-grid">
        <!-- Left Column: Plans -->
        <div class="plans-section">
          <div class="plans-list">
            <!-- Basic Plan -->
            <div class="plan-card" [class.selected]="selectedPlan?.id === 'basic'" (click)="selectPlan(plans[0])">
              <div class="plan-header">
                <h3 class="plan-name">{{ plans[0].name }}</h3>
              </div>
              <div class="plan-price">
                <span class="amount">{{ plans[0].price }}</span>
                <span class="currency">/ month</span>
              </div>
              <div class="plan-credits">
                <span class="checkmark">✓</span>
                <span>{{ plans[0].credits }} credits</span>
              </div>
              <button class="plan-button" [class.selected]="selectedPlan?.id === 'basic'">
                {{ selectedPlan?.id === 'basic' ? 'Selected' : 'Select Plan' }}
              </button>
            </div>

            <!-- Premium Plan -->
            <div class="plan-card premium-card" [class.selected]="selectedPlan?.id === 'premium'"
              (click)="selectPlan(plans[1])">
              <div class="plan-header">
                <h3 class="plan-name">{{ plans[1].name }}</h3>
              </div>
              <div class="plan-price">
                <span class="amount">{{ plans[1].price }}</span>
                <span class="currency">/ month</span>
              </div>
              <div class="plan-credits">
                <span class="checkmark">✓</span>
                <span>{{ plans[1].credits }} credits</span>
              </div>
              <button class="plan-button selected">
                {{ selectedPlan?.id === 'premium' ? 'Plan Selected' : 'Select Plan' }}
              </button>
            </div>

            <!-- Gold Plan -->
            <div class="plan-card" [class.selected]="selectedPlan?.id === 'gold'" (click)="selectPlan(plans[2])">
              <div class="plan-header">
                <h3 class="plan-name">{{ plans[2].name }}</h3>
              </div>
              <div class="plan-price">
                <span class="amount">{{ plans[2].price }}</span>
                <span class="currency">/ month</span>
              </div>
              <div class="plan-credits">
                <span class="checkmark">✓</span>
                <span>{{ plans[2].credits }} credits</span>
              </div>
              <button class="plan-button" [class.selected]="selectedPlan?.id === 'gold'">
                {{ selectedPlan?.id === 'gold' ? 'Selected' : 'Select Plan' }}
              </button>
            </div>
          </div>
        </div>

        <!-- Right Column: Plan Summary -->
        <div class="summary-section">
          <div class="summary-card">
            <h2 class="summary-title">Plan Summary</h2>

            <div class="summary-content">
              <div class="summary-row">
                <span class="summary-label">Selected Plan</span>
                <span class="summary-value">{{ selectedPlan?.name || 'Premium' }}</span>
              </div>

              <div class="summary-row">
                <span class="summary-label">Credits Included</span>
                <span class="summary-value">{{ selectedPlan?.credits || 500 }} credits</span>
              </div>

              <div class="summary-row">
                <span class="summary-label">Base Price</span>
                <span class="summary-value">{{ selectedPlan?.price || 500 }}.00 EGP</span>
              </div>

              <div class="summary-row">
                <span class="summary-label">Tax (15%)</span>
                <span class="summary-value">{{ calculateTax() }} EGP</span>
              </div>

              <div class="summary-total">
                <span class="total-label">Total Amount</span>
                <span class="total-value">{{ calculateTotal() }} EGP</span>
              </div>

              <button class="btn-confirm" (click)="confirmAndPay()">Confirm Plan & Pay</button>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>
</div>